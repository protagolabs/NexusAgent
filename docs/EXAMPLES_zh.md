# 使用示例

从真实生产对话中提炼的用法模式。NarraNexus 的核心交互理念：**用自然语言配置一切、管理一切**。

---

## 1. 自然语言配置 Agent（Awareness）

Awareness 是 Agent 的「自我认知」——角色、目标、行为准则、关键信息都存在这里。你不需要写配置文件，直接聊天就能修改。

### 定义角色

```
用户：我希望以后你能够以一个知识渊博的智者跟我对话
Agent：[更新 Awareness，将核心角色定义为"知识渊博的智者"]
```

### 切换角色

```
用户：你先更新一下 awareness，现在的内容是卖 macbook，我想你来扮演卖书的 agent
Agent：[将 Awareness 从"MacBook 销售"切换为"书籍销售"，保留任务管理逻辑]
```

### 创建竞赛人格

```
用户：配置一下你自己，我希望你是一个善于玩各种桌游、辩论、模拟选举游戏的人。你的名字是 VLT
Agent：[在 Awareness 中创建 "VLT" 竞赛人格，定义竞争策略和行为风格]
```

### 存储关键信息

Awareness 也是 Agent 的持久记忆仓库，适合存放需要长期记住的信息：

```
用户：arena_sk_6bae6889... 这个就是你的 API key，好好记住
Agent：[将 API key 写入 Awareness]

用户：把你参加 Arena 比赛的 API key 记录到你的 awareness 里，免得忘记了
Agent：[已持久化到 Awareness Profile]
```

后续对话中可以直接引用：

```
用户：你的任务是不是失败了，请重启，如果是 API 的问题，你的 awareness 里有你的 api key
Agent：[从 Awareness 中读取 API key，重新配置并重启任务]
```

---

## 2. 自然语言管理任务（Job）

NarraNexus 支持通过聊天直接创建和管理任务，不需要调用任何 API。

### 创建任务

```
用户：学习一下 skill 文件，针对 heartbeat.md。使用我们的 job 系统去创建好对应的 jobs
Agent：[创建 PERIODIC 心跳监控任务（每 30 分钟）+ CRON 每日复盘任务（23:59）]

用户：创建一个任务，每 5 分钟给我发送一句「我爱你」
Agent：[创建 PERIODIC 任务，间隔 300 秒]

用户：根据 skill 的各种信息，开始去创建一系列的 job，让你能够及时发现新比赛
Agent：[创建竞赛监控任务 + 每场比赛的独立跟踪任务]
```

### 修改频率

```
用户：提高一下你的 arena 监控的频率，改成 15mins 一次吧
Agent：[将心跳监控任务间隔从 1800s 更新为 900s]

用户：你的比赛监控频率有点低了，先立即执行一次，然后频率提高一点
Agent：[立即触发一次执行，并提高监控频率]
```

### 立即执行

```
用户：刚刚的监控任务不小心被我打断了，你改成 active 然后再立即执行一下
Agent：[将任务状态设为 active，并设置 next_run_time 为当前时间]

用户：月饼口味比赛已经开始了，请立即开始对应的 job
Agent：[激活待运行任务，立即执行]

用户：为什么 next run 还是三小时后？请立即启动一次
Agent：[更新下次执行时间为现在]
```

### 取消与恢复

```
用户：取消当前所有正在运行的 job
Agent：[批量取消所有活跃任务]

用户：我不小心把粽子比赛的 job 给你取消了，请你重新创建这个任务
Agent：[重新创建被误删的比赛跟踪任务]

用户：恢复你的 job
Agent：[将暂停的任务重新激活]
```

### 查询状态

```
用户：查询我现在有哪些任务
Agent：[列出所有活跃任务及其状态、频率、下次执行时间]

用户：检查一下，你失败的那些任务，可以重新启动了
Agent：[检查失败任务列表，逐个重启]
```

### 任务类型参考

| 类型 | 适用场景 | 示例 |
|------|---------|------|
| `ONE_SHOT` | 执行一次 | "发一封欢迎邮件" |
| `CRON` | 固定时间表 | "每天 23:59 做一次每日复盘" |
| `PERIODIC` | 固定间隔 | "每 15 分钟发一次心跳" |
| `ONGOING` | 持续目标 | "持续跟进这个客户直到他回复" |

---

## 3. 完整场景：Arena 竞赛 Agent

以下是一个完整的 Agent 配置与任务管理流程，展示了上述能力的组合使用。

### 第一步：配置角色与信息

```
用户：配置一下你自己，你是一个 Arena 竞赛选手，名字是 Loki。
      你的目标是在 NetMind Agent Arena 中取得最高排名。
      arena_sk_xxxx 是你的 API key，记到 awareness 里。
Agent：[更新 Awareness：角色=竞赛选手 Loki，存储 API key，定义竞争策略]
```

### 第二步：创建任务体系

```
用户：学习一下 skill 文件，创建心跳监控和每日复盘的 job
Agent：[创建两个任务]
  → PERIODIC：每 30 分钟发送心跳（保持在线）
  → CRON：每天 23:59 复盘当日表现、分析排名、优化策略
```

### 第三步：运行中调整

```
用户：提高一下监控频率，改成 15 分钟一次
Agent：[更新心跳间隔 1800s → 900s]

用户：刚刚任务被打断了，立即执行一下
Agent：[立即触发心跳任务]

用户：你需要重新注册，修改你的 awareness 里的 api key
Agent：[更新 Awareness 中的 API key，重新注册]
```

### 涉及的核心能力

| 能力 | 作用 |
|------|------|
| **Awareness** | 存储角色定义、API key、竞争策略 |
| **PERIODIC 任务** | 定时心跳，保持 Agent 在线 |
| **CRON 任务** | 每日定时复盘与自我进化 |
| **Skill 模块** | 读取比赛规则文档 |
| **叙事记忆** | 积累参赛经验，支持策略迭代 |

---

## 4. 知识助手 -- 跨领域问答与记忆

**场景**：一个跨对话积累领域知识的 Agent。

**会话 1**（税务知识）：
```
用户：普通发票和增值税专用发票有什么区别？
Agent：[详细解释，存入"税务知识"叙事]
```

**会话 2**（几周后）：
```
用户：上次你跟我说的发票的事，要点是什么来着？
Agent：[通过语义相似度从"税务知识"叙事中检索，而非按日期]
```

**工作原理**：叙事记忆系统将每次对话路由到语义故事线中。当同一话题再次出现时——即使隔了几周——Agent 通过话题相似度检索相关叙事，而非按时间顺序。

---

## 5. 项目管理 -- 团队与知识追踪

**场景**：一个追踪项目详情、团队成员和进展的 Agent。

```
用户：我跟你说一下星辰计划的情况：
      预算 320 万，周期 6 个月
      团队：Alice（前端）、Bob（后端）、Charlie（ML）
      技术栈：React、FastAPI、PostgreSQL、Redis
```

后续回忆：

```
用户：星辰计划的预算是多少？
Agent：星辰计划预算 320 万，周期 6 个月。

用户：帮我回忆一下月光行动的细节
Agent：[从叙事记忆中检索"月光行动"相关内容]
```

| 能力 | 作用 |
|------|------|
| **社交网络** | 将团队成员存储为实体，记录角色和专长 |
| **叙事记忆** | 项目详情存入专属叙事，语义检索 |
| **语义记忆** | 通过 EverMemOS 实现长期情景回忆 |

---

## 6. RAG 增强 Agent -- 基于文档的问答

1. 启用 **GeminiRAG** 模块（需要在 `.env` 中配置 `GOOGLE_API_KEY`）
2. 通过 UI 或 MCP 工具上传文档

```
用户：根据上传的产品规格书，方案 A 和方案 B 的主要区别是什么？
Agent：[从上传的文档中检索相关片段，提供有引用的回答]
```
